<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>SPAI</title>

        <link rel="shortcut icon" href="http://icanbecreative.com/resources/images/favico.ico" />
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

        <link rel="stylesheet" type="text/css" href="static/styles/mainStyle.css">
        <script type="text/javascript">
        function searchToggle(obj, evt){
            var container = $(obj).closest('.search-wrapper');

            if(!container.hasClass('active')){
                  container.addClass('active');
                  evt.preventDefault();
            }
            else if(container.hasClass('active') && $(obj).closest('.input-holder').length == 0){
                  container.removeClass('active');
                  // clear input
                  container.find('.search-input').val('');
                  // clear and hide result container when we press close
                  container.find('.result-container').fadeOut(100, function(){$(this).empty();});
            }
        }


    function requestSearch(obj, evt) {
    value = $(obj).find('.search-input').val().trim();
    console.log(value)
    var SEARCH_ENDPOINT = "http://35.163.124.249:8080/search";


    var input = {
      "searchtype":"GS",
      "query": "Who is interested in oil ?",
      "restrict": ['PERSON'],  
    }
    jQuery.support.cors = true;


    var settings = {
    data: JSON.stringify(input),
    success: searchSuccess,
    error: searchError,
    type: 'POST'

    }

    jQuery.ajax(SEARCH_ENDPOINT, settings) 
    
    }


    function searchSuccess(data, textStatus, jqXHR) {
    console.log(data);
    }
    function searchError(jqXHR, error, errorThrown) {
    console.log(jqXHR);
    console.log(error);
    }

        </script>

    </head>

    <body>
        <div class ="search-description">
            <h1>Welcome to SPAI search engine!</h1>
            <hr>
            <h1>Search and connect to interesting people and find what they care about</h1>
        </div>
        
        <form onsubmit="requestSearch(this, event);">
            <div class="search-wrapper">
                <div class="input-holder">
                    <input name="query" type="text" class="search-input" placeholder="Type to search" />
                    <button class="search-icon" onclick="searchToggle(this, event);"><span></span></button>
                </div>
                <span class="close" onclick="searchToggle(this, event);"></span>
                <div class="result-container">
                </div>
            </div>
        </form>
    </body>

</html>
